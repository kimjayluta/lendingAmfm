var E=E||function(d,t){var e={},a=e.lib={},n=function(){},i=a.Base={extend:function(t){n.prototype=this;var e=new n;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=a.WordArray=i.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||o).stringify(this)},concat:function(t){var e=this.words,a=t.words,n=this.sigBytes;if(t=t.sigBytes,this.clamp(),n%4)for(var i=0;i<t;i++)e[n+i>>>2]|=(a[i>>>2]>>>24-i%4*8&255)<<24-(n+i)%4*8;else if(65535<a.length)for(i=0;i<t;i+=4)e[n+i>>>2]=a[i>>>2];else e.push.apply(e,a);return this.sigBytes+=t,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=d.ceil(e/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],a=0;a<t;a+=4)e.push(4294967296*d.random()|0);return new s.init(e,t)}}),r=e.enc={},o=r.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var a=[],n=0;n<t;n++){var i=e[n>>>2]>>>24-n%4*8&255;a.push((i>>>4).toString(16)),a.push((15&i).toString(16))}return a.join("")},parse:function(t){for(var e=t.length,a=[],n=0;n<e;n+=2)a[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new s.init(a,e/2)}},c=r.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var a=[],n=0;n<t;n++)a.push(String.fromCharCode(e[n>>>2]>>>24-n%4*8&255));return a.join("")},parse:function(t){for(var e=t.length,a=[],n=0;n<e;n++)a[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new s.init(a,e)}},l=r.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},u=a.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=l.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,a=e.words,n=e.sigBytes,i=this.blockSize,r=n/(4*i);if(t=(r=t?d.ceil(r):d.max((0|r)-this._minBufferSize,0))*i,n=d.min(4*t,n),t){for(var o=0;o<t;o+=i)this._doProcessBlock(a,o);o=a.splice(0,t),e.sigBytes-=n}return new s.init(o,n)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});a.Hasher=u.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(t,e){return new a.init(e).finalize(t)}},_createHmacHelper:function(a){return function(t,e){return new h.HMAC.init(a,e).finalize(t)}}});var h=e.algo={};return e}(Math);!function(){var t=E,s=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,a=t.sigBytes,n=this._map;t.clamp(),t=[];for(var i=0;i<a;i+=3)for(var r=(e[i>>>2]>>>24-i%4*8&255)<<16|(e[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|e[i+2>>>2]>>>24-(i+2)%4*8&255,o=0;o<4&&i+.75*o<a;o++)t.push(n.charAt(r>>>6*(3-o)&63));if(e=n.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var e=t.length,a=this._map;(n=a.charAt(64))&&-1!=(n=t.indexOf(n))&&(e=n);for(var n=[],i=0,r=0;r<e;r++)if(r%4){var o=a.indexOf(t.charAt(r-1))<<r%4*2,d=a.indexOf(t.charAt(r))>>>6-r%4*2;n[i>>>2]|=(o|d)<<24-i%4*8,i++}return s.create(n,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(r){function x(t,e,a,n,i,r,o){return((t=t+(e&a|~e&n)+i+o)<<r|t>>>32-r)+e}function w(t,e,a,n,i,r,o){return((t=t+(e&n|a&~n)+i+o)<<r|t>>>32-r)+e}function T(t,e,a,n,i,r,o){return((t=t+(e^a^n)+i+o)<<r|t>>>32-r)+e}function S(t,e,a,n,i,r,o){return((t=t+(a^(e|~n))+i+o)<<r|t>>>32-r)+e}for(var t=E,e=(n=t.lib).WordArray,a=n.Hasher,n=t.algo,B=[],i=0;i<64;i++)B[i]=4294967296*r.abs(r.sin(i+1))|0;n=n.MD5=a.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var a=0;a<16;a++){var n=t[o=e+a];t[o]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}a=this._hash.words;var i,r,o=t[e+0],d=(n=t[e+1],t[e+2]),s=t[e+3],c=t[e+4],l=t[e+5],u=t[e+6],h=t[e+7],f=t[e+8],p=t[e+9],g=t[e+10],v=t[e+11],A=t[e+12],m=t[e+13],$=t[e+14],b=t[e+15],C=a[0],y=S(y=S(y=S(y=S(y=T(y=T(y=T(y=T(y=w(y=w(y=w(y=w(y=x(y=x(y=x(y=x(y=a[1],r=x(r=a[2],i=x(i=a[3],C=x(C,y,r,i,o,7,B[0]),y,r,n,12,B[1]),C,y,d,17,B[2]),i,C,s,22,B[3]),r=x(r,i=x(i,C=x(C,y,r,i,c,7,B[4]),y,r,l,12,B[5]),C,y,u,17,B[6]),i,C,h,22,B[7]),r=x(r,i=x(i,C=x(C,y,r,i,f,7,B[8]),y,r,p,12,B[9]),C,y,g,17,B[10]),i,C,v,22,B[11]),r=x(r,i=x(i,C=x(C,y,r,i,A,7,B[12]),y,r,m,12,B[13]),C,y,$,17,B[14]),i,C,b,22,B[15]),r=w(r,i=w(i,C=w(C,y,r,i,n,5,B[16]),y,r,u,9,B[17]),C,y,v,14,B[18]),i,C,o,20,B[19]),r=w(r,i=w(i,C=w(C,y,r,i,l,5,B[20]),y,r,g,9,B[21]),C,y,b,14,B[22]),i,C,c,20,B[23]),r=w(r,i=w(i,C=w(C,y,r,i,p,5,B[24]),y,r,$,9,B[25]),C,y,s,14,B[26]),i,C,f,20,B[27]),r=w(r,i=w(i,C=w(C,y,r,i,m,5,B[28]),y,r,d,9,B[29]),C,y,h,14,B[30]),i,C,A,20,B[31]),r=T(r,i=T(i,C=T(C,y,r,i,l,4,B[32]),y,r,f,11,B[33]),C,y,v,16,B[34]),i,C,$,23,B[35]),r=T(r,i=T(i,C=T(C,y,r,i,n,4,B[36]),y,r,c,11,B[37]),C,y,h,16,B[38]),i,C,g,23,B[39]),r=T(r,i=T(i,C=T(C,y,r,i,m,4,B[40]),y,r,o,11,B[41]),C,y,s,16,B[42]),i,C,u,23,B[43]),r=T(r,i=T(i,C=T(C,y,r,i,p,4,B[44]),y,r,A,11,B[45]),C,y,b,16,B[46]),i,C,d,23,B[47]),r=S(r,i=S(i,C=S(C,y,r,i,o,6,B[48]),y,r,h,10,B[49]),C,y,$,15,B[50]),i,C,l,21,B[51]),r=S(r,i=S(i,C=S(C,y,r,i,A,6,B[52]),y,r,s,10,B[53]),C,y,g,15,B[54]),i,C,n,21,B[55]),r=S(r,i=S(i,C=S(C,y,r,i,f,6,B[56]),y,r,b,10,B[57]),C,y,u,15,B[58]),i,C,m,21,B[59]),r=S(r,i=S(i,C=S(C,y,r,i,c,6,B[60]),y,r,v,10,B[61]),C,y,d,15,B[62]),i,C,p,21,B[63]);a[0]=a[0]+C|0,a[1]=a[1]+y|0,a[2]=a[2]+r|0,a[3]=a[3]+i|0},_doFinalize:function(){var t=this._data,e=t.words,a=8*this._nDataBytes,n=8*t.sigBytes;e[n>>>5]|=128<<24-n%32;var i=r.floor(a/4294967296);for(e[15+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e[14+(n+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(e.length+1),this._process(),e=(t=this._hash).words,a=0;a<4;a++)n=e[a],e[a]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return t},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),t.MD5=a._createHelper(n),t.HmacMD5=a._createHmacHelper(n)}(Math),function(){var t,e=E,a=(t=e.lib).Base,c=t.WordArray,n=(t=e.algo).EvpKDF=a.extend({cfg:a.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var a=(o=this.cfg).hasher.create(),n=c.create(),i=n.words,r=o.keySize,o=o.iterations;i.length<r;){d&&a.update(d);var d=a.update(t).finalize(e);a.reset();for(var s=1;s<o;s++)d=a.finalize(d),a.reset();n.concat(d)}return n.sigBytes=4*r,n}});e.EvpKDF=function(t,e,a){return n.create(a).compute(t,e)}}(),E.lib.Cipher||function(t){var e=(f=E).lib,a=e.Base,o=e.WordArray,n=e.BufferedBlockAlgorithm,i=f.enc.Base64,r=f.algo.EvpKDF,d=e.Cipher=n.extend({cfg:a.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,a){this.cfg=this.cfg.extend(a),this._xformMode=t,this._key=e,this.reset()},reset:function(){n.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(n){return{encrypt:function(t,e,a){return("string"==typeof e?p:h).encrypt(n,t,e,a)},decrypt:function(t,e,a){return("string"==typeof e?p:h).decrypt(n,t,e,a)}}}});e.StreamCipher=d.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var s=f.mode={},c=function(t,e,a){var n=this._iv;n?this._iv=void 0:n=this._prevBlock;for(var i=0;i<a;i++)t[e+i]^=n[i]},l=(e.BlockCipherMode=a.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();l.Encryptor=l.extend({processBlock:function(t,e){var a=this._cipher,n=a.blockSize;c.call(this,t,e,n),a.encryptBlock(t,e),this._prevBlock=t.slice(e,e+n)}}),l.Decryptor=l.extend({processBlock:function(t,e){var a=this._cipher,n=a.blockSize,i=t.slice(e,e+n);a.decryptBlock(t,e),c.call(this,t,e,n),this._prevBlock=i}}),s=s.CBC=l,l=(f.pad={}).Pkcs7={pad:function(t,e){for(var a,n=(a=(a=4*e)-t.sigBytes%a)<<24|a<<16|a<<8|a,i=[],r=0;r<a;r+=4)i.push(n);a=o.create(i,a),t.concat(a)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},e.BlockCipher=d.extend({cfg:d.cfg.extend({mode:s,padding:l}),reset:function(){d.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var a=e.createEncryptor;else a=e.createDecryptor,this._minBufferSize=1;this._mode=a.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var u=e.CipherParams=a.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),h=(s=(f.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?o.create([1398893684,1701076831]).concat(t).concat(e):e).toString(i)},parse:function(t){var e=(t=i.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){var a=o.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return u.create({ciphertext:t,salt:a})}},e.SerializableCipher=a.extend({cfg:a.extend({format:s}),encrypt:function(t,e,a,n){n=this.cfg.extend(n);var i=t.createEncryptor(a,n);return e=i.finalize(e),i=i.cfg,u.create({ciphertext:e,key:a,iv:i.iv,algorithm:t,mode:i.mode,padding:i.padding,blockSize:t.blockSize,formatter:n.format})},decrypt:function(t,e,a,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),t.createDecryptor(a,n).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}})),f=(f.kdf={}).OpenSSL={execute:function(t,e,a,n){return n||(n=o.random(8)),t=r.create({keySize:e+a}).compute(t,n),a=o.create(t.words.slice(e),4*a),t.sigBytes=4*e,u.create({key:t,iv:a,salt:n})}},p=e.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:f}),encrypt:function(t,e,a,n){return a=(n=this.cfg.extend(n)).kdf.execute(a,t.keySize,t.ivSize),n.iv=a.iv,(t=h.encrypt.call(this,t,e,a.key,n)).mixIn(a),t},decrypt:function(t,e,a,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),a=n.kdf.execute(a,t.keySize,t.ivSize,e.salt),n.iv=a.iv,h.decrypt.call(this,t,e,a.key,n)}})}(),function(){for(var t=E,e=t.lib.BlockCipher,a=t.algo,o=[],n=[],i=[],r=[],d=[],s=[],c=[],l=[],u=[],h=[],f=[],p=0;p<256;p++)f[p]=p<128?p<<1:p<<1^283;var g=0,v=0;for(p=0;p<256;p++){var A=(A=v^v<<1^v<<2^v<<3^v<<4)>>>8^255&A^99;o[g]=A;var m=f[n[A]=g],$=f[m],b=f[$],C=257*f[A]^16843008*A;i[g]=C<<24|C>>>8,r[g]=C<<16|C>>>16,d[g]=C<<8|C>>>24,s[g]=C,C=16843009*b^65537*$^257*m^16843008*g,c[A]=C<<24|C>>>8,l[A]=C<<16|C>>>16,u[A]=C<<8|C>>>24,h[A]=C,g?(g=m^f[f[f[b^m]]],v^=f[f[v]]):g=v=1}var y=[0,1,2,4,8,16,32,64,128,27,54];a=a.AES=e.extend({_doReset:function(){for(var t=(a=this._key).words,e=a.sigBytes/4,a=4*((this._nRounds=e+6)+1),n=this._keySchedule=[],i=0;i<a;i++)if(i<e)n[i]=t[i];else{var r=n[i-1];i%e?6<e&&4==i%e&&(r=o[r>>>24]<<24|o[r>>>16&255]<<16|o[r>>>8&255]<<8|o[255&r]):(r=o[(r=r<<8|r>>>24)>>>24]<<24|o[r>>>16&255]<<16|o[r>>>8&255]<<8|o[255&r],r^=y[i/e|0]<<24),n[i]=n[i-e]^r}for(t=this._invKeySchedule=[],e=0;e<a;e++)i=a-e,r=e%4?n[i]:n[i-4],t[e]=e<4||i<=4?r:c[o[r>>>24]]^l[o[r>>>16&255]]^u[o[r>>>8&255]]^h[o[255&r]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,i,r,d,s,o)},decryptBlock:function(t,e){var a=t[e+1];t[e+1]=t[e+3],t[e+3]=a,this._doCryptBlock(t,e,this._invKeySchedule,c,l,u,h,n),a=t[e+1],t[e+1]=t[e+3],t[e+3]=a},_doCryptBlock:function(t,e,a,n,i,r,o,d){for(var s=this._nRounds,c=t[e]^a[0],l=t[e+1]^a[1],u=t[e+2]^a[2],h=t[e+3]^a[3],f=4,p=1;p<s;p++){var g=n[c>>>24]^i[l>>>16&255]^r[u>>>8&255]^o[255&h]^a[f++],v=n[l>>>24]^i[u>>>16&255]^r[h>>>8&255]^o[255&c]^a[f++],A=n[u>>>24]^i[h>>>16&255]^r[c>>>8&255]^o[255&l]^a[f++];h=n[h>>>24]^i[c>>>16&255]^r[l>>>8&255]^o[255&u]^a[f++],c=g,l=v,u=A}g=(d[c>>>24]<<24|d[l>>>16&255]<<16|d[u>>>8&255]<<8|d[255&h])^a[f++],v=(d[l>>>24]<<24|d[u>>>16&255]<<16|d[h>>>8&255]<<8|d[255&c])^a[f++],A=(d[u>>>24]<<24|d[h>>>16&255]<<16|d[c>>>8&255]<<8|d[255&l])^a[f++],h=(d[h>>>24]<<24|d[c>>>16&255]<<16|d[l>>>8&255]<<8|d[255&u])^a[f++],t[e]=g,t[e+1]=v,t[e+2]=A,t[e+3]=h},keySize:8}),t.AES=e._createHelper(a)}();var A=function(){function a(){}return a.option=function(t,e){0<=$.inArray(e,[void 0,null,""])||(e="Enter an option");var a=$("<li/>",{class:"textContainer cfgroup","data-disabled":"true"});return a.append([$("<span/>",{class:"radiomark"}),$("<input/>",{type:"radio",disabled:"disabled"}),$("<textarea/>",{rows:"1",placeholder:e,class:"answer outline-0 text",readonly:"readonly"}).attr("autocomplete","off").text(t)]),a},a.otherOpt=function(){var t=$("<li/>",{class:"cfgroup"});return t.append([$("<span/>",{class:"radiomark"}),$("<input/>",{type:"radio",disabled:"disabled"}),$("<a/>",{class:"_addOption",href:"javascript:void(0);"}).text("Add Option")," or ",$("<a/>",{class:"_addOther",href:"javascript:void(0);"}).text("Add Other")]),t},a.otherVar=function(){var t=$("<li/>",{class:"cfgroup"});return t.append([$("<span/>",{class:"radiomark"}),$("<input/>",{type:"radio",disabled:"disabled"}),$("<a/>",{class:"_addOption",href:"javascript:void(0);"}).text("Add another variable")]),t},a.card=function(t){""===t&&(t="Untitled Question");var e=$("<div/>",{class:"card"}),a=$("<div/>",{class:"textContainer","data-disabled":"true"});return e.append(a.append($("<textarea/>",{class:"question outline-0 text",placeholder:"Enter a question or a title",readonly:"readonly",rows:"1"}).attr("autocomplete","off").text(t))),e.css("display","none")},a.grid=function(t){0<=$.inArray(t,[void 0,null,""])&&(t="Untitled Variable Handler");var e=$("<li/>",{class:"grid"}),a=$("<div/>",{class:"textContainer","data-disabled":"true"}).append($("<textarea/>",{class:"question outline-0 text",placeholder:"Enter name for this handler",readonly:"readonly",rows:"1"}).attr("autocomplete","off").text(t));return e.append(a),e.css("display","none")},a.page=function(t){return""===t&&(t="Untitled Page"),$("<span>",{class:"page",placeholder:""}).text(t)},a.dataTable=function(){return $("<table class='dataTable' border='1' cellspacing='0'><thead><tr></tr></thead><tbody/></table>").css("width","100%")},a.dataTableCriteria=function(t){return t=$.isArray(t)?$(t).map(function(t,e){return a.cell(e)}).toArray():a.cell(t),$("<tr/>").append(t)},a.dataTableCriteriaH=function(t){return t=$.isArray(t)?$(t).map(function(t,e){return a.cellHead(e)}).toArray():a.cellHead(t),$("<tr/>").append(t)},a.cell=function(t){return null==t&&(t=""),$("<td/>",{"data-disabled":"true"}).append($("<textarea/>",{class:"cell outline-0 text",rows:"1",title:"",readonly:"readonly"}).text(t))},a.cellHead=function(t){return null==t&&(t=""),$("<th/>",{"data-disabled":"true"}).append($("<textarea/>",{class:"cell outline-0 text",rows:"1",title:"",readonly:"readonly"}).text(t)).css("minWidth","50px")},a.secretCell=function(t,e){return t="number"!=typeof t?t:String.fromCharCode(t),$("<th/>").append($("<div/>").text(t.repeat(e)))},a.secretCellNormal=function(t){return $("<td/>").append($("<div/>").text(t).css("padding","0 5px"))},a.toolImg=function(t,e){return $("<div/>",{class:"tool c-pointer","data-id":t}).append($("<img/>",{alt:"",width:"100%"}).attr("src",e))},a.toolSpan=function(t,e){return $("<div/>",{class:"tool c-pointer","data-id":t}).append($("<span/>",{class:"glyphicon glyphicon-"+e,id:"","aria-hidden":!0,title:""}))},a.tableSelector=function(){return $("<div/>",{class:"tableSelector"}).append($("<div/>",{class:"topSelector"}),$("<div/>",{class:"leftSelector"}),$("<div/>",{class:"rightSelector"}),$("<div/>",{class:"bottomSelector"}))},a.contextMenu={container:function(){return $("<ul/>",{id:"contextMenu"})},icon:function(t){return $("<span/>",{class:"glyphicon glyphicon-"+t,"aria-hidden":!0})},name:function(t){return $("<span/>",{class:"menuText"}).html(" "+t)}},a}(),g=function(){function n(){}return n.Option=$(".sortableOption"),n.Cards=$(".cellList"),n.Grid=$(".gridList"),n.sortOption=function(){this.Option.sortable({items:"> li:not(:last)",axis:"y",stop:function(t,e){var a=$(e.item);a.removeAttr("style");var n=a.parents("ul.sortableOption"),i=a.parents("div.card").attr("data-origin-i"),r=n.find("li.textContainer").map(function(t,e){return $(e).find("textarea.text").val()}).toArray().map(function(t){return{value:t,image:null,correct:!1}});$(document).trigger("datos.changeOption",[r,i])},placeholder:"text-placeholder",containment:"parent",tolerance:"pointer",cursor:"move"}),this.Option.disableSelection()},n.sortCard=function(){var a={},t=this.Cards.multisortable({items:"div.card",axis:"y",click:function(t,e){$(document).trigger("datos.cardSelected",[e.find("div.datosSheet").length])},selectstart:function(t){return null===b.$activeDataTable},start:function(t,e){$(document).trigger("datos.cardUnselected"),$(".card-placeholder").css("height",$(e.item).height())},sort:function(t,e){0<$.inArray(a.bottom,[null,void 0])&&(a.bottom=$(e.item).parents(".cellList").height()+50),0<$.inArray(a.top,[null,void 0])&&(a.top=$(e.item).parents(".cellList").offset().top-100),e.offset.top>=a.bottom?$(e.item).css("top",a.bottom):e.offset.top<=a.top&&$(e.item).css("top",a.top)},stop:function(t,e){$(e.item).removeAttr("style"),$(document).trigger("datos.cardSelected",[$(e.item).find("div.datosSheet").length]),$(document).trigger("datos.sortCard",[n.Cards])},selectedClass:"selected",placeholder:"card-placeholder",tolerance:"pointer",scroll:!0,scrollSensitivity:50,scrollSpeed:100,cursor:"move"});this.Cards.disableSelection(),t.find(".text").on("mousedown selectstart",function(t){$(this).hasClass("non-handler")&&t.stopImmediatePropagation()}),t.find(".dataTable").on("mousedown selectstart",function(t){$(this).hasClass("active")&&t.stopImmediatePropagation()})},n.sortGrid=function(){this.Grid.multisortable({items:"li.grid",click:function(t,e){},selectstart:function(t){},start:function(t,e){$(".grid-placeholder").css("height",$(e.item).height())},sort:function(t,e){},stop:function(t,e){$(e.item).removeAttr("style"),$(document).trigger("datos.sortCard",[n.Grid])},selectedClass:"selected",placeholder:"grid-placeholder",tolerance:"pointer",scroll:!0,scrollSensitivity:50,scrollSpeed:100,cursor:"move"})},n.run=function(){n.Option=$(".sortableOption"),this.sortOption(),this.sortCard(),this.sortGrid()},n}(),u=function(){function t(t){this.selector=$(t),this.div1Opt={insertRow:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABF1BMVEUAAAAA//8AgP8zmf8rgP8rgOokku0eh/AAAAAeh/AgivQAAAAAAAAAAAAii/QAAAAii/EAAAAAAAAhivMAAAAhi/MAAAAiifEAAAAAAAAhivIhi/IiifMgivEhifIhivIICAgiifEhi/IhivIDBwogivMECg8MDAwGDBIQEBATExMgivIgi/IUFBQhivMKCgoDBgoMDAwDBwshivIbN1EdOlYaNE0hivJZWVkJCQlPT08IERoLCwsSIjMTExM5OTkhivIhivIhivIhivIhivIBAQEGBgYHBwcLCwsMDAwRERETExMhivIxYJA2a6BAnfpNmeVOpf1Uqf9Vqv9Wqv93d3eioqKkpKS4uLjg4ODj4+P7+/v///+cAyV4AAAARXRSTlMAAQIFBgwOESEiMDU5PkRGS09VVVZWW1tfYWRlam91enuAiouWpqusrbCyvcXJzO3v7/Dx8vP09PT19ff39/j4+fv8/f4U5QEeAAAAAWJLR0Rc6tgAlwAAAOlJREFUSMdjYBgFo4A0YOmKBtwIarELi0YBkR6EtYTHoICoIazFxtMbBXi5E9TCLYgG+AdbMmBlZ2dngjA5xHABHmQdUo4+zrJQtoS1CXZgq4akQ9bZx1EaxpEwDcEO/DTgGhiVfXzMBRhI0MKi6uPjoyQMAczEaGHV9kECbMhaAv2xa2FUxKklOAiXX+RcfHzkOdnZSfA+g7iDj5M4Kd4HAj5jHycZuBazAOzAF1kLA5eOnp4olC1kYIQDqAzqcoxXEg2IENSiaW+BAqz0CWrRQi8uDIewltAIFBBOWIuCLhpQH61ABxwAAOdHsAn/RjmhAAAAAElFTkSuQmCC",insertCol:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABF1BMVEUAAAAA//+AgP9mmf9Vqv9dov8AAABapf9Vqv9Vqv8AAAAAAABYp/9Srf8AAABXqP9Vqv8AAABYq/9Wqf9Vqv8AAABYq/8AAAAAAABVqv9Wqf9Vqv8AAABXq/8AAABXq/8AAABWqf9Vqv8AAABWq/8AAABWqf9Wqf9Wq/8AAABWqf9Wq/9Wqf8AAABWqv8AAABWqv8AAABWqv9Wqv9Vqv8BAQECAgIEBAQCAgJWqv8EBAQAAABXqv9Wqv9Wqv8AAABWqv9Wqv9Wqv9Wqv8RERFWqv8FBQVWqv8AAAACAwUIEBgJEBkOHCkTJTcaGhoxMTE9ebVAQEBAf75QUFBSUlJSofJWqv+bm5ucnJzIyMjKysr8/Pz///+9oYAKAAAASHRSTlMAAQIFBgsOERIVFx0dHyQmLTU6Ozw9Q0hLS01RUlVnbW50eHl8fYOGiJWYmqesrLCxsrjJy9LT1NXV1tng5ejs8ff6+/z9/v4YronKAAAAAWJLR0Rc6tgAlwAAAQFJREFUSMdjYBhuQNkcAnSxyImaQeRMuVCENd2CQcDPCi7CwwRjSXgEguT8PbhRtbjEgEAIXAuvrRZCSxRILoKAFnbLsDAlkrQwG4WFhbnKkqCFUScMBJzEiNeiHgYBDgLEahFxD7MzCHPWDgszIVaLdJgdv1qYM5NemA3RWhyFGVTCnBlYjYnWIiXJwKAI1MLAYUSsFhYglgdpYeAkISqhWhiorSUaBHBoiQTJhaNr8YAAC5iAkIY6QgsUoGoRV4UAOSz5hQ8qp8pGzRwqY48A+sRpUfDw8YUCT2titQRBU3KY96iWUS2jWka1UFtLQCgUeBGtBQGI1CJoiADKVCqBAazN0xe0aYEuAAAAAElFTkSuQmCC",removeRow:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABm1BMVEUEBAUFBQUICg0KDhERERESGR8THikZJC8fHx8hFx0oQ18vLy8ySWszMzM7PVY/Pz9Wqv9bpfhfX19fofFomORxM0pzjdN8hMZ9g8R+KDmGebaHDRCLi4uUbKKYhISbm5ufn5+hm5unp6eoV4OysrK+U1O/QGC/QWG/v7/Ly8vMEhvPz8/UK0HV1dXWKT7XBAXYQEDf39/hHy7jxcXkCAzmICDoJSXqkpLsExzt7e3x8fH1Cg/4Bwr5Bgn8AwT8Fxf9AQH+AQH+AgL/AAD/AQH/AwP/BAT/BQX/Bgb/Bwf/CAj/DQ3/EBD/EhL/FRX/HR3/Hh7/ISH/IiL/JCT/LS3/NDT/NTX/Njb/OTn/PT3/RUX/T0//UFD/Vlb/WVn/XFz/aWn/cnL/dnb/d3f/enr/g4P/jIz/kpL/lJT/np7/n5//paX/qKj/qqr/sbH/urr/wMD/w8P/xcX/zc3/0dH/1NT/19f/2Nj/2tr/3t7/5ub/6Oj/6en/6ur/6+v/8fH/9PT/9fX/9vb/+Pj/+fn/+/v//f3//v7///9WNpRvAAAAAWJLR0SIa2YWWgAAAWtJREFUSMft1udPwkAYBvC6FRx1b8U9cOHeim/d4kLFvffeuLf0/my5K1f0YtPji8GE50P75Hh/aZtcSgXkcwS/JaVMyvRJ3M/EGH2+MXOA/CnZ3vAuOx2PHORAgl3aHyZh7l2XnA8B9B4r/XUGAJZknQ3zMeaegpEr3OUV3GGfknwmhRYlTRIe66qzWFrXiZh9o0QI00gmGayOCi4ixf6kPkuEqJViMlqR3INPtmvEQeKriOnGh/4TxEPExFrwRDpEfERMavaQLcRLxDQrEQsyPylRLmJzcpMC+iwT95wk20oJTL9wkdQOPNxeTsyyzEFS2vBoZ0Z0AzFrXhJi+D2x9WQy3RCeYydtRyVZbHJNOHmNZK7GXSsvh3HtoxtAiGQSZFZ+WMVjiy7STwfcffRW6zVu9JDPeQAH3e97AINnSI+g56nxO3V189su0ybo5sK76jpCPIT7LylA9EgCk1B9YmLT8n8/SPyVfAHKKQCbdnjC7wAAAABJRU5ErkJggg==",removeCol:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABX1BMVEUHCAoICQohBwkrUno9JjNSo/RVQmJWqv9mmudrld9tk92EhISGebaKdbCOcaqQcKiUAwShZGSiXo2mVH2vVVXBwcHExMTOmZnXAQLfYmLhHi3i4uLnGCTpBQbpCAzpFSDsExz4Bwr4CAj7BAb9AAD9AgP9AwP+AgL/AAD/AQH/AwP/BQX/Bgb/CAj/Cgr/DQ3/ExP/GRn/Gxv/Hh7/ICD/JSX/Jib/KSn/Kyv/LS3/MDD/MzP/Ojr/PDz/Pj7/QED/SEj/Skr/S0v/TU3/UFD/UVH/UlL/Vlb/X1//YWH/Y2P/bW3/bm7/dXX/eHj/gID/goL/g4P/j4//k5P/lZX/mZn/mpr/m5v/p6f/qan/srL/trb/uLj/vr7/ycn/09P/1tb/3Nz/3d3/4OD/4+P/5+f/6Oj/6en/6ur/6+v/7+//8fH/9PT/9vb/+fn/+vr/+/v//Pz//f3//v7///+N99dCAAAAAWJLR0R0322obQAAATZJREFUSMdjKMEA3MzsUMDKUIIFMIxqGdUyqmWwa0lH0ZJBhJYI3WgkLQJGSQS1RGlr6AnCtQhraBgnE9ASo6OhoaHEBtUhBORomKbi1VJkAVKkIccF1sGvCub54rcl0RCsSoETqIMPosMxn4Bf4g3A6mQ42HmUwSy7XIIhFqcPVinFqwimrbOJiJdYXQ0EkMgkKvaj1OA65JmITDAiKlAdsiyMRGqRloToUBcXFSNSS5oZ1BaP4hLitGRZwf3iTZyWHBukEAsgRkuBK1itpiWECiWspdANYnxwvhNETzghLcUeEB2BJSW59mCWViQBLT4QHX5gT9mC2TrR+BO/C1iVJyRwM8zBTgvDb0u+M1CRFyw6wHpCCHk/z0HDvRDOSzHRCCIcyNk+yBkkwZ+4BEMIjGqhgxYAQv6pcDRBaAoAAAAASUVORK5CYII=",insertCardAfter:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAA0lBMVEUDAwQEBgcGBwkLCwsNDQ0QGSEREREZJzQiM0UrUno1O0A4ODg4PEA6PUBAf75QUFBWqv9XV1dXqv9Zq/9crf9eXl5frv9lsv9zuf91uv95eXl6vP+EhISFhYWQx/+RyP+azP+czf+hoaGl0v+m0v+np6er1f+vr6+w1/+x2P+z2f+5ubm63P+73f+93v/C4P/F4v/GxsbLy8vS6P/V6v/d7v/e3t7k5OTm8//p6ens9v/t7e3u9v/v9//09PT19fX2+v/4+Pj6/f/8/f/+/v////9b7HSrAAAAAWJLR0RFjrOoVwAAALVJREFUSMft1NcOgjAUgGHcW4977wUK4kLFiaPv/0pKQoKYHsO573/XJl/SlUqMnCSIIEQybeMN+CSfa2CVUwgZo2tYCcIloShWGCHXkzdz72befrpzH0xLCqIFMh6y1R2SALRs8oucuzAhkadSgdqDQoz6Zzjb2F18EatXcCd1X0QtApUwo2kP+7KsatrB515eiypAh9EO2RqVYEm8F3YcKg6JxNFiae6D2c3/tBYfrCCCUHoDGeM2s2EsS1UAAAAASUVORK5CYII=",insertCardBefore:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAA0lBMVEUFBwgJDA8LDhIMEBQSGSATFxoUGyMWGBodHR0oKCgpKSkpSmoxMTE1NTVMTExNmORWqv9Xqv9Zq/9aWlphsP9ksf9lsv9nsv9oaGhos/9vt/96vP+Av/+Dwf+KxP+UlJSUyf+WlpaWyv+azP+kpKSl0v+u1v+zs7Oz2f+53P+73f/G4v/H4//I4//KysrNzc3Q5//W1tbb29vf39/f7//i4uLq6urt7e3v9//w8PDw9//y+f/z+f/0+f/2+//39/f4+//5/P/6/f/9/v/+/v////8FYJugAAAAAWJLR0RFjrOoVwAAALZJREFUSMft1LcOwjAQgOFQQ+fokNBN76G3UELu/V+JIYsHH4rZIvkfLX3SucgaSqcpokggyLPzq4uIHLU0XWjLkc/UuHokAnRxjmwM6KIMufcL0LjJkHkVAEzGGGMTX+Tc5taavogzLMoSxL0JAC3bfkts353VABYod8ivUbnieCScp4vyV4mPpYuIiCc9Rqfv/n2W1pruICbJVIYqUSeIRQ7RU0RIciWqLEHGA7qV+pMVCQT5AudzNdwE9ofaAAAAAElFTkSuQmCC",duplicateCard:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAb1BMVEUEBAQGBgYOExkQExYREhMSFBYVHCMZLUAaGxsaJC8cKjgfLj0mP1goRGApSGctVX4vLy81NTU1aZ1Om+hWqv9ZXWFaXmFgYGCBgYGXl5eenp6/v7/BwcHHx8fKysrPz8/m5ub4+Pj5+fn7+/v///8WtU2lAAAAAWJLR0QktAb5mQAAAGpJREFUSMft1DcOgDAQRFGTczY5Grj/GanWFLZW0Lja3z9pqmH37xgRIgbIKdAuDbHQWK8jAtsxETFAXAfy1o8kbaB4kWTbkYaMQ4kkVQmFfqRWaMhbW3MsIgrpghzL1pB5xDvoLYkQ+dcDQ3RAuRveqQ0AAAAASUVORK5CYII="},this.div2Opt={toggleText:"eye-open",lockCell:"lock",cardFormat:"adjust",framework:"tasks",deleteCard:"trash",cardUp:"chevron-up",cardDown:"chevron-down",editCard:"pencil"}}return t.formulaFocused=!1,t.prototype={div1:function(t){var e=this.selector.find("#div1");if(e.hide(),e.html(""),$.isArray(t)){for(var a=0;a<t.length;a++)e.append(A.toolImg(t[a],this.div1Opt[t[a]]));e.show(),d.noZoomVtoolbar()}},div2:function(t){var e=this.selector.find("#div2");if(e.hide(),e.html(""),$.isArray(t)){for(var a=0;a<t.length;a++)e.append(A.toolSpan(t[a],this.div2Opt[t[a]]));e.show(),d.noZoomVtoolbar()}},formulaBar:function(t){t?$("#formulaBar").show():$("#formulaBar").hide()}},t}(),n=new u("#vToolbar"),r=function(){function t(){}return t.px2Vh=0,t.construct=function(){this.px2Vh=1/$(window).height()*100},t.antiZoom=function(t,e,a){var n,i;return n=null==a?t.css(e):a,i=parseInt(n)*this.px2Vh+"vh",t.css(e,i),i},t}();r.construct(),$.fn.extend({fixedCss:function(t,e){var a={};if($.isArray(t)){for(var n=0;n<t.length;n++)a[t[n]]=r.antiZoom(this,t[n],e);return a}return r.antiZoom(this,t,e)}});var d=function(){function e(){}return e.headerHeight=0,e.pageCSS=null,e.noZoomPagination=function(){var t=$(".page:not(.menu)"),e=$("#dbPage");null===this.pageCSS&&(this.pageCSS=t.fixedCss(["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","height"]),this.pageCSS.marginLeft=t.fixedCss("marginLeft")),t.css(this.pageCSS),e.css(this.pageCSS)},e.vToolbarCSS=null,e.formulaBarCSS=null,e.formulaBarInputCSS=null,e.$vToolbarC=null,e.$vToolbarCe=null,e.noZoomVtoolbar=function(){var t=$("#vToolbar");null===this.vToolbarCSS&&(this.vToolbarCSS=t.fixedCss(["width","marginTop","right"]),t.find(">div:first").fixedCss("marginBottom"));t.find(".tool").each(function(){null===e.$vToolbarCe?e.$vToolbarCe=$(this).fixedCss(["lineHeight","height"],$(this).css("width")):$(this).css(e.$vToolbarCe),null===e.$vToolbarC?e.$vToolbarC=$(this).fixedCss(["fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"]):$(this).css(e.$vToolbarC)})},e.noZoomSubTool=function(){var t=$("#formulaBar");null===this.formulaBarCSS&&(this.formulaBarCSS=t.fixedCss(["right","padding","paddingLeft","paddingRight","paddingTop","paddingBottom","fontSize"])),null===this.formulaBarInputCSS&&(this.formulaBarInputCSS=t.find("input").fixedCss(["fontSize","width","height","lineHeight","padding","paddingLeft","paddingRight","paddingTop","paddingBottom"]));var e=$("#subTool");e.fixedCss(["padding","right"]);var a=e.find("div.subtool");a.fixedCss(["height","width","borderWidth","lineHeight"]),a.eq(0).fixedCss("marginBottom")},e.mainWrapF=function(){var t=parseInt($("#bottomBar").css("height")),e=parseInt($("header").css("height")),a=t*r.px2Vh;this.headerHeight=e*r.px2Vh;var n=this.headerHeight+"%",i=100-(a+this.headerHeight)+"%";$("#main_wrap").css({top:n,height:i})},e.noZoomContextMenu={container:function(t){t.fixedCss(["fontSize","border-top-width","border-bottom-width","border-left-width","border-right-width","border-top-left-radius","border-top-right-radius","border-bottom-left-radius","border-bottom-right-radius"])},item:function(t){t.find("*").each(function(){$(this).fixedCss(["paddingLeft","paddingRight","paddingTop","paddingBottom"]),$(this).css("fontSize","inherit")})}},e.run=function(){$("nav").fixedCss("fontSize"),$("#bottomBar").fixedCss("fontSize"),this.mainWrapF(),this.noZoomVtoolbar(),this.noZoomSubTool(),n.formulaBar(!1)},e}();d.run();var i=function(){function t(){}return t.$activePage=null,t.pageNum=1,t.run=function(){this.pageEvents(),this.addPage("Page 1")},t.pageEvents=function(){},t.addPage=function(t,e,a){var n=A.page(t),i=$("#pageList");i.append(n),n.attr("data-target-i",this.pageNum);var r=""===t?"Untitled Page":t;if($(document).trigger("datos.addPage",[this.pageNum,r,a]),e){var o=i.outerWidth()-i.width();i.scrollLeft(o),n.dblclick(),0<$.inArray(a,[null,void 0])||"handler"!==a||n.addClass("handler")}else n.addClass("active"),$(document).trigger("datos.selectPage",[this.pageNum]);d.noZoomPagination(),this.pageNum++},t.setCaretPosition=function(t,e){if("last"===e&&(e=$(t).text().length<0?0:$(t).text().length),0<e){var a=document.createRange(),n=window.getSelection();a.setStart(t.childNodes[0],e),a.collapse(!0),n.removeAllRanges(),n.addRange(a)}},t.selectPage=function(t){if(!$(t).hasClass("active")){null!==v.$activeText&&(v.defaultVal(v.$activeText),v.disable()),$(".page:not(.menu)").removeClass("active"),$(t).addClass("active"),$(document).trigger("datos.selectPage",[$(t).attr("data-target-i")]);var e=localStorage.getItem("_aPD"),a=E.AES.decrypt(e,"U2FsdGVkX18ZUVvShFSES21qHsQEqZXMxQ9zgHy+bu0=");a=a.toString(E.enc.Utf8),a=JSON.parse(a),$("#pageTitle").val(a._header.title),$("#pageDescription").val(a._header.description),m.clearCard("all");var n=$(".gridList"),i=$(".cellList, #addAnother");if(n.find(".grid").remove(),"handler"===a._pType)return n.show(),i.hide(),void $(a._cardArrangement).each(function(t,e){setTimeout(function(){o.genCard(e,!1,a._cards[e])},100*t)});"standard"===a._pType&&(n.hide(),i.show(),$(a._cardArrangement).each(function(t,e){setTimeout(function(){m.genCard(e,!1,a._cards[e])},100*t)}))}},t}(),m=function(){function p(){}return p.allowEvent=!0,p.$cardList=null,p.cardNum=0,p.currType=null,p.run=function(){p.selectionEvent(),this.addCard()},p.selectionEvent=function(){$(document).on("datos.cardSelected",function(t,e){if(p.allowEvent){var a=["cardFormat","cardUp","cardDown","editCard","deleteCard"];e&&a.unshift("toggleText"),n.div1(["insertCardAfter","insertCardBefore","duplicateCard"]),n.div2(a)}}),$(document).on("datos.cardUnselected",function(){p.allowEvent&&(n.div1(""),n.div2(""),$(document).trigger("datos.toggleSubTool"))})},p.toggleSelection=function(t){this.allowEvent=t},p.addCard=function(){return this.genCard(p.cardNum,!0)},p.genCard=function(t,e,a){void 0===a&&(a={title:"Untitled Question",_options:{variables:[{value:"Option #1"}]},_optionType:0,_cardType:"standard"});var n,i=A.card(a.title).attr("data-origin-i",t),r=i.find("div.textContainer"),o=function(t){i.append(n),$(".cellList").append(i),i.show({complete:t,duration:250}),p.$cardList=$(".card"),v.$textList=$(".text"),g.run(),e&&($(document).trigger("datos.addCard",[p.cardNum]),$(".card.selected").removeClass("selected"),$(document).trigger("datos.cardUnselected"),i.addClass("selected"),$(document).trigger("datos.cardSelected")),p.cardNum++};if("standard"===a._cardType&&(n=$("<ul/>",{class:"sortableOption"}),$(a._options.variables).each(function(){n.append(A.option(this.value))}),n.append(A.otherOpt()),o()),"tabular"===a._cardType){n=$("<div/>",{class:"datosSheet"}).css("position","relative");var d,s=A.dataTable(),c=s.find("tbody"),l=a._options.criteria,u=a._options.matrix,h=$(l).map(function(t,e){return e.value}).toArray(),f=$(l).map(function(t,e){return e.width}).toArray();c.append(A.dataTableCriteriaH(h)),$(a._options.variables).each(function(e,a){d=$(l).map(function(t){return 0<t?void 0!==u[e]&&void 0!==u[e][t-1]?u[e][t-1]:"":a.value}).toArray(),d=A.dataTableCriteria(d),c.append(d)}),n.append(s),o(function(){b.generate(s,f)})}return r},p.deleteCard=function(){this.clearCard("selected")},p.clearCard=function(t){var e=$(".card");if("all"!==t){var a=[];e=e.map(function(t,e){if($(e).hasClass("selected"))return a.push($(e).attr("data-origin-i")),e}),$(document).trigger("datos.deleteCard",[a])}e.remove(),p.$cardList=e,v.$textList=$(".text")},p.getOptions=function(t){return t.find("li.textContainer").map(function(t,e){return{value:$(e).find("textarea.text").val()}}).toArray()},p.getVariables=function(t){var e=t.find("table.dataTable tbody tr");return(e=e.not(":first")).map(function(t,e){return $(e).children().eq(1).find("textarea.text").val()})},p}(),o=function(){var p=function(){};return p.$cardList=null,p.addCard=function(){return this.genCard(m.cardNum,!0)},p.genCard=function(t,e,a){void 0===a&&(a={title:"Untitled Variable Handler",_options:{variables:[{value:"Option #1"}]},_optionType:0,_cardType:"varHandler"}),console.log(a);var n,i=A.grid(a.title).attr("data-origin-i",t),r=i.find("div.textContainer"),o=function(t){i.append(n),i.insertBefore($("#addAnotherGrid")),i.show({complete:t,duration:250}),p.$cardList=$(".card"),v.$textList=$(".text"),e&&($(document).trigger("datos.addGrid",[m.cardNum]),$(".grid.selected").removeClass("selected"),i.addClass("selected")),m.cardNum++};if("varHandler"===a._cardType&&(n=$("<ul/>",{class:"sortableOption"}),$(a._options.variables).each(function(){n.append(A.option(this.value,"Enter variable name"))}),n.append(A.otherVar()),o()),"tabular"===a._cardType){n=$("<div/>",{class:"datosSheet"}).css("position","relative");var d,s=A.dataTable(),c=s.find("tbody"),l=a._options.criteria,u=a._options.matrix,h=$(l).map(function(t,e){return e.value}).toArray(),f=$(l).map(function(t,e){return e.width}).toArray();c.append(A.dataTableCriteriaH(h)),$(a._options.variables).each(function(e,a){d=$(l).map(function(t){return 0<t?void 0!==u[e]&&void 0!==u[e][t-1]?u[e][t-1]:"":a.value}).toArray(),d=A.dataTableCriteria(d),c.append(d)}),n.append(s),o(function(){b.generate(s,f)})}return r},p.deleteGrid=function(){this.clearGrid()},p.clearGrid=function(t){var e=$(".grid");if("all"!==t){var a=[];e=e.map(function(t,e){if($(e).hasClass("selected"))return a.push($(e).attr("data-origin-i")),e})}e.remove(),p.$cardList=e,v.$textList=$(".text")},p}(),v=function(){function o(){}return o.$textList=$(".text"),o.$activeText=null,o.firstLoad=!0,o.run=function(){this.resize(),this.disable(),this.textEvents()},o.resize=function(t){$(t).css("height","auto"),o.firstLoad?o.firstLoad=!1:($(t).css("height",$(t)[0].scrollHeight+"px"),$(document).trigger("datos.textResize",[$(t)]))},o.delayedResize=function(t){var e=this;window.setTimeout(function(){e.resize(t)},0)},o.defaultVal=function(t){var e,a=$(t),n=a.parent()[0].nodeName,i=a.parent().context.id;a.val().length<1&&("LI"===n?0===$(t).parent().prev().length&&0===$(t).val().length&&$(t).val("Option #1"):"DIV"===n&&("pageTitle"===i?a.val("Page Title[Untitled]"):"pageDescription"!==i&&a.val("Untitled Question")));if("DIV"===n)"pageTitle"===i?($("#pageDescription").dblclick(),$(document).trigger("datos.changeTitle",[t])):"pageDescription"===i?($("textarea.text.question").eq(1).dblclick(),$(document).trigger("datos.changeDescription",[t])):((e=a.parents("div.card")).length||(e=a.parents("li.grid")),e=e.attr("data-origin-i"),$(document).trigger("datos.changeCardTitle",[t,e]));else if("LI"===n){var r=a.parents("ul.sortableOption");r=r.find("li.textContainer"),(e=a.parents("div.card")).length||(e=a.parents("li.grid"));var o=r.map(function(t,e){return{value:$(e).find("textarea.text").val()}}).toArray();e=e.attr("data-origin-i"),$(document).trigger("datos.changeOption",[o,e])}},o.disable=function(){this.$textList.trigger("blur"),this.$textList.attr("readonly","readonly"),this.$textList.parent().attr("data-disabled","true"),this.$textList.removeClass("non-handler"),this.$activeText=null,window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},o.enable=function(t){var e=$(t);e.removeAttr("readonly"),e.addClass("non-handler"),e.parent().attr("data-disabled","false"),(o.$activeText=e).focus().select()},o.removeOption=function(t){var e,a,n;if(e=$(t).parent().prev(),a=$(t).parents("ul.sortableOption"),(n=$(t).parents("div.card")).length||(n=$(t).parents("li.grid")),e.length&&!$(t).is("#pageDescription")&&!$(t).hasClass("cell")){$(t).parent().remove();var i=m.getOptions(a);n=n.attr("data-origin-i"),$(document).trigger("datos.changeOption",[i,n]),o.$activeText=null}},o.smartOption=function(t,e){if(0<$(t).val().length){var a=$(t).parent().next();if(e){if(a.hasClass("textContainer"))a.find("textarea.text").dblclick();else{var n=$(t).parent(),i=A.option("");i.insertAfter(n),o.$textList=$(".text"),i.find("textarea.text").dblclick();var r=$(t).parents("div.card");r.length||(r=$(t).parents("li.grid")),r=r.attr("data-origin-i"),$(document).trigger("datos.addOption",[r])}return}this.disable()}else this.removeOption(t)},o.textEvents=function(){$(document).on("datos.disableText",function(){o.disable()}),$(document).on("datos.updateText",function(){o.$textList=$(".text")})},o}();!function(t,e){"function"==typeof define&&define.amd?define(["exports"],e):"undefined"!=typeof exports?e(exports):e(t.dragscroll={})}(this,function(t){var d,s,c=window,l=document,u="mousemove",h="mouseup",f="mousedown",e="EventListener",p="add"+e,a="remove"+e,n=[],i=function(t,e){for(t=0;t<n.length;)(e=(e=n[t++]).container||e)[a](f,e.md,0),c[a](h,e.mu,0),c[a](u,e.mm,0);for(n=[].slice.call(l.getElementsByClassName("dragscroll")),t=0;t<n.length;)!function(e,a,n,i,r,o){(o=e.container||e)[p](f,o.md=function(t){e.hasAttribute("nochilddrag")&&l.elementFromPoint(t.pageX,t.pageY)!=o||(i=1,a=t.clientX,n=t.clientY,t.preventDefault())},0),c[p](h,o.mu=function(){i=0},0),c[p](u,o.mm=function(t){i&&((r=e.scroller||e).scrollLeft-=d=-a+(a=t.clientX),r.scrollTop-=s=-n+(n=t.clientY),e==l.body&&((r=l.documentElement).scrollLeft-=d,r.scrollTop-=s))},0)}(n[t++])};"complete"==l.readyState?i():c[p]("load",i,0),t.reset=i});var t=function(){function t(){}return t.contentGen=function(t,e){return"<b>"+t+"</b> <br> <span style='font-style: italic'>("+e+")</span>"},t.run=function(){$("#moveUp").tooltip({content:this.contentGen("Move Card Up","Drag the card up"),position:{at:"right top-10"},open:function(t,e){_JSR.uiToolTip($(e.tooltip),this.offsetTop)}}),$("#moveDown").tooltip({content:this.contentGen("Move Card Down","Drag the card down"),position:{at:"right top-10"},open:function(t,e){_JSR.uiToolTip($(e.tooltip),this.offsetTop)}}),$("#duplicate").tooltip({content:this.contentGen("Duplicate Card","Press Ctrl+D to Execute"),position:{at:"right top-10"},open:function(t,e){_JSR.uiToolTip($(e.tooltip),this.offsetTop)}}),$("#edit").tooltip({content:this.contentGen("Edit Card Content","Double click to edit"),position:{at:"right top-10"},open:function(t,e){_JSR.uiToolTip($(e.tooltip),this.offsetTop)}}),$("#delete").tooltip({content:this.contentGen("Delete Card","Press DELETE key to execute"),position:{at:"right top-10"},open:function(t,e){_JSR.uiToolTip($(e.tooltip),this.offsetTop)}})},t}(),e=function(){function r(){$(document).on("datos.changeCardTitle datos.changeTitle datos.changeDescription datos.addCard datos.sortCard datos.deleteCard datos.addOption datos.changeOption datos.addPage datos.changePage datos.selectPage datos.switchPage datos.changeType datos.preFormatCard datos.changeCriterions ",function(t){console.log(t.namespace,r.dataArray[r.pageActive])})}return r.dataArray={},r.pageActive=0,r.obj={changeCurrPageTitle:function(t){r.dataArray[r.pageActive]._header.title=t},changeCurrPageDescription:function(t){r.dataArray[r.pageActive]._header.description=t},addNewCard:function(t,e){var a,n;n=0<=$.inArray(e,[null,void 0,"standard"])?(a="Untitled Question","standard"):(a="Untitled Variable Handler","varHandler"),r.dataArray[r.pageActive]._cards[t]={title:a,_options:{variables:[{value:"Option #1"}]},_optionType:0,_cardType:n},r.dataArray[r.pageActive]._cardArrangement.push(t.toString())},changeCurrCardTitle:function(t,e){r.dataArray[r.pageActive]._cards[t].title=e},changeCurrCardArrangement:function(t){r.dataArray[r.pageActive]._cardArrangement=t},deleteCardList:function(e){for(var t=$.grep(r.dataArray[r.pageActive]._cardArrangement,function(t){return $.inArray(t.toString(),e)<0}),a=e.length-1;0<=a;a--)delete r.dataArray[r.pageActive]._cards[Number(e[a])];r.dataArray[r.pageActive]._cardArrangement=t},changeCardListType:function(t,i){if($.isArray(t))$(t).each(function(t,e){if(e=Number(e),"tabular"===(r.dataArray[r.pageActive]._cards[e]._cardType=i)){var a=r.dataArray[r.pageActive]._cards[e]._options.variables,n={};$(a).each(function(t){n[t]=[""]}),r.dataArray[r.pageActive]._cards[e]._options={variables:a,criteria:[{value:"Variables"},{value:"Untitled Criterion"}],matrix:n}}else delete r.dataArray[r.pageActive]._cards[e]._options.criteria});else{var e=Number(t);r.dataArray[r.pageActive]._cards[e]._cardType=i}},returnCardType:function(t){var e=r.dataArray[r.pageActive]._cards[Number(t)]._cardType;console.log("here",e)},addCardOption:function(t){r.dataArray[r.pageActive]._cards[Number(t)]._options.variables.push({value:""})},addCardCriterion:function(t){r.dataArray[r.pageActive]._cards[Number(t)]._options.criteria.push({value:""})},updateCardOption:function(t,e){r.dataArray[r.pageActive]._cards[Number(e)]._options.variables=t},updateCardCriterion:function(t,e){r.dataArray[r.pageActive]._cards[Number(e)]._options.criteria=t},updateCardMatrix:function(t,e){r.dataArray[r.pageActive]._cards[Number(e)]._options.matrix=t},addNewPage:function(t,e,a){var n="Page Handler Title[Untitled]";0<=$.inArray(a,[null,void 0])&&(a="standard",n="Page Title[Untitled]"),r.dataArray[t]={_pName:e,_pType:a,_header:{title:n,description:"",designType:"standard"},_cards:{},_cardArrangement:[]}},changePageData:function(t,e){r.dataArray[t]._pName=e},switchPage:function(t){r.pageActive=t;var e=E.AES.encrypt(JSON.stringify(r.dataArray[t]),"U2FsdGVkX18ZUVvShFSES21qHsQEqZXMxQ9zgHy+bu0=");localStorage.setItem("_aPD",e)}},r.primeChange={TITLE:void $(document).on("datos.changeTitle",function(t,e){r.obj.changeCurrPageTitle(e.val())}),DESCRIPTION:void $(document).on("datos.changeDescription",function(t,e){r.obj.changeCurrPageDescription(e.val())})},r.gridCards={ADD:void $(document).on("datos.addGrid",function(t,e){r.obj.addNewCard(e,"handler")}),CHANGE_TITLE:void 0},r.normalCards={ADD:void $(document).on("datos.addCard",function(t,e){r.obj.addNewCard(e)}),CHANGE_TITLE:void $(document).on("datos.changeCardTitle",function(t,e,a){r.obj.changeCurrCardTitle(a,e.val())}),CHANGE_ORDER:void $(document).on("datos.sortCard",function(t,e){r.obj.changeCurrCardArrangement(e.sortable("toArray",{attribute:"data-origin-i"}))}),REMOVE:void $(document).on("datos.deleteCard",function(t,e){r.obj.deleteCardList(e)}),CONVERT:function(){$(document).on("datos.changeType",function(t,e,a){r.obj.changeCardListType(e,a)})},RETURN_FORMAT:function(){$(document).on("datos.preFormatCard",function(t,e){console.log("putang ina naman"),r.obj.returnCardType(e)})}},r.optionSystem={ADD:void $(document).on("datos.addOption",function(t,e){r.obj.addCardOption(e)}),CHANGE:void $(document).on("datos.changeOption",function(t,e,a){r.obj.updateCardOption(e,a)})},r.tabularSystem={ADD_VARIABLE:void $(document).on("datos.addVariable",function(t,e){r.obj.addCardOption(e)}),CHANGE_VARIABLE:void $(document).on("datos.changeVariable",function(t,e,a){r.obj.updateCardOption(e,a)}),ADD_CRITERIA:void $(document).on("datos.addCriterion",function(t,e){r.obj.addCardCriterion(e)}),CHANGE_CRITERIA:void $(document).on("datos.changeCriterions",function(t,e,a){r.obj.updateCardCriterion(e,a)}),CHANGE_MATRIX:void $(document).on("datos.changeMatrix",function(t,e,a){r.obj.updateCardMatrix(e,a)})},r.pageSystem={ADD:void $(document).on("datos.addPage",function(t,e,a,n){r.obj.addNewPage(e,a,n)}),CHANGE:void $(document).on("datos.changePage",function(t,e,a){r.obj.changePageData(e,a)}),SELECT:void $(document).on("datos.selectPage",function(t,e){r.obj.switchPage(e)})},r}(),b=function(){function v(){$(".dataTable").each(function(){v.generate($(this))}),v.textResize()}return v.$activeDataTable=null,v.$selectedCell=null,v.moveDataTable=function(t,e,a){t.css({marginTop:1-parseInt(e.css("height")),marginLeft:-a})},v.removeNLeft=function(t){var e=parseInt(t.attr("data-lastNleft"));t.css({width:parseInt(t.css("width"))-(e-4)})},v.addNLeft=function(t,e){t.css({width:parseInt(t.css("width"))+e}),t.attr("data-lastNleft",e)},v.close=function(t){t||"false"!==this.$selectedCell.attr("data-disabled")?(this.$activeDataTable.removeClass("active"),this.$activeDataTable.find(".nonSelectable").each(function(){$(this).addClass("secretTableTool")}),this.$activeDataTable.parents(".datosSheet").css("overflow","hidden"),this.moveSelector(null),this.$activeDataTable=null,m.toggleSelection(!0),n.formulaBar(!1),$(document).trigger("datos.cardUnselected"),$(document).trigger("datos.cardSelected")):null!==v.$activeDataTable&&$(document).trigger("datos.disableText")},v.generate=function(e,a){e.attr({"data-letter":65,"data-repeat":1,"data-number":1});var t,n=e.find("thead tr:eq(0)");n.html("");var i,r=parseInt(e.attr("data-number"));e.find("tbody tr").each(function(){(t=A.secretCellNormal(r)).addClass("secretTableTool nonSelectable"),$(this).prepend(t),e.attr("data-number",r+1),r=parseInt(e.attr("data-number"))}),e.find("tbody tr th").each(function(){(i=$(this).clone()).addClass("secretTableTool nonSelectable"),n.append(i)});var o=parseInt(e.attr("data-letter")),d=parseInt(e.attr("data-repeat"));e.find("thead tr th").each(function(){$(this).html(""),$(this).css("minWidth","50px"),$(this).append($("<div/>").text(String.fromCharCode(o).repeat(d)));var t=90===o;e.attr("data-letter",t?65:o+1),e.attr("data-repeat",t?d+1:d),o=parseInt(e.attr("data-letter")),repeat=parseInt(e.attr("data-repeat"))});var s=A.secretCell("*",1);s.css({background:"#d6d6d67a",width:"1%","white-space":"nowrap"}),s.addClass("secretTableTool nonSelectable"),n.prepend(s),$nLeft=s.width(),s.attr("data-orig-width",$nLeft),s.width($nLeft),this.moveDataTable(e,n,$nLeft),this.addNLeft(e,$nLeft);var c=e.parents(".datosSheet");c.css("overflow","hidden"),c.append(A.tableSelector());for(var l=n.children().length,u=[],h=1;h<l;h++)u.push(h);void 0===a&&null!==a||(e.find("thead tr th").not(":first").each(function(t){void 0!==a[t]&&$(this).css("width",a[t])}),s.width($nLeft)),v.columnTextResize(u,e),this.columnResize(e),this.rowResize(e)},v.moveSelector=function(t){var e=this.$activeDataTable;if(this.removeColRow(t),null!==t&&null!==e){if(!t.hasClass("nonSelectable")){this.$selectedCell=t;var a=parseInt(e.css("marginLeft")),n=t.height(),i=t.outerWidth(),r=t.offset().top-$(e).offset().top,o=t.offset().left-$(e).offset().left+a,d=e.parents("div.datosSheet").find(".tableSelector");d.css("display","block"),d.find(".topSelector").css({top:r,width:i,left:o}),d.find(".bottomSelector").css({top:r+n+2,width:i,left:o}),d.find(".leftSelector").css({top:r,height:n+2,left:o}),d.find(".rightSelector").css({top:r,height:n+4,left:o+i-1})}}else this.$selectedCell=null,$(".tableSelector").css("display","none");null!==this.$selectedCell?(this.getColIndex(!1),this.getRowIndex(!1)):(this.colIndex=null,this.rowIndex=null)},v.textResize=function(){$(document).on("datos.textResize",function(){null!==v.$activeDataTable&&v.moveSelector(v.$selectedCell)})},v.colIndex=null,v.getColIndex=function(t){return(null===this.colIndex||null!=t&&!t)&&(this.colIndex=v.$selectedCell.index()),this.colIndex},v.addColumn=function(t,e){var a,n;if(null!=t&&(null==e&&(e=0),t+=e),null==t)v.$activeDataTable.find("tbody").find("tr").each(function(){a=$(this),n=0===a.index()?A.cellHead():A.cell(),a.append(n)});else{var i,r=null;v.$activeDataTable.find("tbody").find("tr").each(function(){a=$(this),i=a.children().eq(t),0===a.index()?(n=A.cellHead(),r=n):n=A.cell(),n.insertAfter(i)}),e<0&&v.getColIndex(!1),v.moveSelector(r)}$(document).trigger("datos.updateText"),v.$activeDataTable.find("thead tr th").not(":first").not(":last").resizable("destroy");var o=parseInt(v.$activeDataTable.attr("data-letter")),d=parseInt(v.$activeDataTable.attr("data-repeat")),s=A.secretCell(o,d);s.addClass("nonSelectable"),v.$activeDataTable.find("thead tr:eq(0)").append(s);var c=90===o;v.$activeDataTable.attr("data-letter",c?65:o+1),v.$activeDataTable.attr("data-repeat",c?d+1:d),v.columnResize(v.$activeDataTable)},v.columnEmpty=function(t){var e;null==t&&(t=this.$activeDataTable);var a=!0;return t.find("tbody").find("tr").each(function(){if(0<(e=$(this).children().eq(v.getColIndex())).length&&0<e.find("textarea.cell").val().length)return a=!1}),a},v.columnRemove=function(t,e){null==e&&(e=this.$activeDataTable);var a=e.find("tbody").find("tr");if(1<t){var n=a.eq(0).children().length;if(2===t&&n<=3)a.eq(0).children().eq(2).find("textarea").val("Untitled Criteria").trigger("change");else{var i;a.each(function(){0<(i=$(this).children().eq(t)).length&&i.remove()}),e.find("thead").find("tr:eq(0) th:last").remove();var r=parseInt(e.attr("data-letter"));e.attr("data-letter",r-1)}}else a.eq(0).children().eq(1).find("textarea").val("Variables").trigger("change"),a.eq(1).children().eq(1).find("textarea").val("Untitled Variable").trigger("change")},v.columnTextResize=function(e,t){var a,n;t.find("tbody").find("tr").each(function(){a=$(this).children();for(var t=0;t<e.length;t++)0<(n=a.eq(e[t])).length&&n.find("textarea.cell").trigger("change")})},v.columnResize=function(a){var n,i,r,o,d,s,c=a.find("thead tr th:first"),l=c.attr("data-orig-width");a.find("thead tr th").not(":first").not(":last").resizable({handles:"e"}).on("resize",function(t,e){if(c.width(l),i=e.originalSize.width-e.size.width,r=Number($(this).next().attr("data-orig-width"))+i,o=50-r,r<=50)return $(this).next().css("width","50px"),$(this).css("width",e.size.width-o),void v.moveSelector(v.$selectedCell);$(this).next().css("width",r),n.each(function(){$(this).css("width",$(this).attr("data-orig-width"))}),d=0<$(this).next().length,s=d?[$(this).index(),$(this).next().index()]:[$(this).index()],v.columnTextResize(s,a),v.moveSelector(v.$selectedCell)}).on("resizestart",function(){(n=$(this).parent().find("th").not(":first").not($(this))).each(function(){$(this).attr("data-orig-width",$(this).width())}),n=n.not($(this).next())})},v.rowIndex=null,v.getRowIndex=function(t){return(null===this.rowIndex||null!=t&&!t)&&(this.rowIndex=v.$selectedCell.parents("tr").index()),this.rowIndex},v.addRow=function(t,e){null!=t&&(null==e&&(e=0),t+=e);var a,n,i=v.$activeDataTable,r=i.find("tbody"),o=r.children(),d=(a=null==t?this.$selectedCell.parents("tr"):o.eq(t)).children().length,s=$("<tr/>");null==t?r.append(s):(s.insertAfter(a),o=r.children());for(var c=0;c<d-1;c++)n=A.cell(),s.append(n);$(document).trigger("datos.updateText"),r.find("tr td.nonSelectable").resizable("destroy");var l=parseInt(i.attr("data-number")),u=s,h=o.eq(t+1);if(null!=t&&0<h.length){for(var f=t+2;f<o.length;f++)o.eq(f-1).prepend(o.eq(f).find(".nonSelectable"));u=o.eq(o.length-1)}if(u.prepend(A.secretCellNormal(l).addClass("nonSelectable")),(l-1).toString().length!==l.toString().length){var p=i.find("thead tr:eq(0)"),g=p.find("th:first").width();v.removeNLeft(i),v.moveDataTable(i,p,g),v.addNLeft(i,g)}i.attr("data-number",l+1),v.rowResize(i),null!=t&&(e<0&&v.getRowIndex(!1),v.moveSelector(s.children().eq(1)))},v.rowEmpty=function(t){null==t&&(t=this.$activeDataTable);var e=!0;return t.find("tbody tr").eq(v.getRowIndex()).children().not(":first").each(function(){if(0<$(this).find("textarea.cell").val().length)return e=!1}),e},v.rowRemove=function(t,e){null==e&&(e=this.$activeDataTable);var a=e.find("tbody"),n=a.find("tr"),i=n.length;if(0<n.eq(t).next().length){n.eq(t).children().not(":first").each(function(){$(this).remove()});for(var r=v.getRowIndex()+1;r<i;r++)n.eq(r).children().not(":first").each(function(){n.eq(r-1).append($(this))});a.find("tr:last").remove()}else n.eq(t).remove();var o=parseInt(e.attr("data-number"));if((o-1).toString().length!==(o-2).toString().length){var d=e.find("thead tr:eq(0)"),s=d.find("th:first").width();this.removeNLeft(e),this.moveDataTable(e,d,s),this.addNLeft(e,s)}e.attr("data-number",o-1)},v.rowResize=function(t){t.find("tbody tr td.nonSelectable").resizable({handles:"s"}).on("resize",function(){v.moveSelector(v.$selectedCell)})},v.removeColRow=function(t){if(null!==this.$selectedCell){var e=this.getRowIndex(),a=this.getColIndex(),n=this.$activeDataTable.parents("div.card").attr("data-origin-i");if(null!==t&&null!==v.$activeDataTable){var i=t.index(),r=t.parents("tr").index();a!==i&&this.columnEmpty()&&this.columnRemove(a),r!==e&&this.rowEmpty()&&this.rowRemove(e),a===i&&r===e||(1===a&&0!==e?$(document).trigger("datos.changeVariable",[this.getVariables(),n]):0===e?$(document).trigger("datos.changeCriterions",[this.getCriteria(),n]):$(document).trigger("datos.changeMatrix",[this.getMatrix(),n]))}else this.columnEmpty()&&this.columnRemove(a),this.rowEmpty()&&this.rowRemove(e)}},v.getVariables=function(){return this.$activeDataTable.find("tbody tr").not(":first").map(function(t,e){return{value:$(e).children().eq(1).find("textarea.text").val()}}).toArray()},v.getCriteria=function(){var t=this.$activeDataTable,e=t.find("tbody tr:eq(0)>th"),a=t.find("thead tr:eq(0)>th").not(":first");return e.map(function(t,e){return{value:$(e).find("textarea.text").val(),width:a.eq(t).css("width")}}).toArray()},v.getMatrix=function(){var t=this.$activeDataTable.find("tbody tr").not(":first");test=t.map(function(t,e){return $(e).find("textarea").not(":first")});var a={};return test.each(function(t,e){a[t]=$(e).map(function(t,e){return $(e).val()}).toArray()}),a},v}(),a=function(){function t(){this.PageSystem(),this.SmartCards(),this.SmartTextBox(),this.TabularSystem()}return t.prototype.PageSystem=function(){$(document).on("keypress",".page:not(.menu)",function(t){10!==t.which&&13!==t.which&&"Enter"!==t.key||(t.preventDefault(),$(this).focusout())});$(document).on("paste change input",".page:not(.menu)",function(){var t=$(this);setTimeout(function(){t.html(t.text()),i.setCaretPosition(t[0],"last")},0)})},t.prototype.SmartCards=function(){var e;$(document).on("keydown",function(t){e=null===b.$activeDataTable&&null===v.$activeText&&null===i.$activePage,"Escape"===t.key&&e&&(m.$cardList.removeClass("selected"),$(document).trigger("datos.cardUnselected"))});$(document).on("keydown",function(t){"Tab"===t.key&&t.preventDefault()});var a;$(document).on("keydown",function(t){a=null===b.$activeDataTable&&null===v.$activeText&&null===i.$activePage,"Delete"===t.key&&a&&m.deleteCard()});var n;$(document).on("keydown",function(t){n=null===b.$activeDataTable&&null===v.$activeText&&null===i.$activePage,"a"===t.key.toLowerCase()&&t.ctrlKey&&n&&(m.$cardList.addClass("selected"),$(document).trigger("datos.cardSelected"))})},t.prototype.SmartTextBox=function(){$(document).on("change cut paste drop",".text",function(){v.resize($(this))});$(document).on("keydown",".text",function(t){null!==v.$activeText&&v.delayedResize($(this))});$(document).on("keydown",".text",function(t){if(!("Enter"!==t.key&&13!==t.which||t.shiftKey||t.altKey||t.ctrlKey||t.metaKey)){t.preventDefault();var e=$(this).parent()[0].nodeName;if("LI"===e)return v.defaultVal($(this)),v.smartOption($(this),!0),void $(this).trigger("datos.textEnter",[$(this).parent()]);if("DIV"===e){v.defaultVal($(this));var a=$(this).parents("div.card");if(a.length||(a=$(this).parents("li.grid")),a.find("ul").length)return void a.find("textarea.answer.text:eq(0)").dblclick();a.find("div.datosSheet").length&&v.disable(v.$activeText),$(this).trigger("datos.textEnter",[$(this).parent()])}}});$(document).on("keydown",".text",function(t){"Delete"!==t.key||46!==t.which||t.shiftKey||t.altKey||t.ctrlKey||t.metaKey||(v.removeOption(this),$(document).trigger("datos.textDelete"))});$(document).on("keydown",function(t){if(("Escape"===t.key||27===t.which)&&null!==v.$activeText){v.defaultVal(v.$activeText);var e=v.$activeText.parent()[0].nodeName;if("LI"===e)return void v.smartOption(v.$activeText,!1);"DIV"===e&&v.disable(v.$activeText)}});$(document).on("keydown",function(t){"Tab"!==t.key&&9!==t.which||null===v.$activeText||t.preventDefault()})},t.prototype.TabularSystem=function(){$(document).on("keydown",function(t){var e="Tab"===t.key||9===t.which,a="ArrowRight"===t.key||39===t.which,n="ArrowLeft"===t.key||37===t.which,i=b.$selectedCell,r=null!==i,o=!!r&&"true"===i.attr("data-disabled");if(r&&!u.formulaFocused&&(e&&!t.shiftKey||a&&o)){if(i.next().length<1&&!b.columnEmpty()){b.addColumn();var d=b.$activeDataTable.parents("div.card");$(document).trigger("datos.addCriterion",[d.attr("data-origin-i")])}0<i.next().length&&(b.moveSelector(i.next()),$(document).trigger("datos.disableText"))}else r&&!u.formulaFocused&&(e&&t.shiftKey||n&&o)&&0<b.$selectedCell.prev().length&&(b.moveSelector(i.prev()),$(document).trigger("datos.disableText"))});$(document).on("keydown",function(t){var e="Enter"===t.key||13===t.which,a="ArrowDown"===t.key||40===t.which,n="ArrowUp"===t.key||38===t.which,i=b.$selectedCell,r=null!==i,o=r?i.index():null,d=!!r&&"true"===i.attr("data-disabled");if(r&&!u.formulaFocused&&(e&&!t.shiftKey||a&&d)){var s=b.$selectedCell.parents("tr");if(s.next().length<1&&!b.rowEmpty()){b.addRow();var c=b.$activeDataTable.parents("div.card");$(document).trigger("datos.addVariable",[c.attr("data-origin-i")])}0<s.next().length&&(b.moveSelector(s.next().children().eq(o)),$(document).trigger("datos.disableText"))}else if(r&&!u.formulaFocused&&(e&&t.shiftKey||n)&&d){var l=b.$selectedCell.parents("tr").prev();0<l.length&&(b.moveSelector(l.children().eq(o)),$(document).trigger("datos.disableText"))}});$(document).on("keydown",function(t){null!==b.$selectedCell&&"Delete"===t.key&&46===t.which&&b.$selectedCell.find("textarea.cell").text("").val("")});$(document).on("keydown",function(t){var e=b.$selectedCell;if(null!==e&&"true"===e.attr("data-disabled")&&!u.formulaFocused){var a=48<=t.which&&t.which<=90,n=96<=t.which&&t.which<=111,i=186<=t.which&&t.which<=222;(a||n||i)&&e.find("textarea.cell").text(t.key).dblclick()}});$(document).on("keydown",function(t){null===b.$selectedCell||"Escape"!==t.key&&27!==t.which||b.close()})},t}(),s=function(){function t(){this.PageSystem(),this.SmartCards(),this.SmartTextBox(),this.TabularSystem(),this.vToolbar()}return t.prototype.PageSystem=function(){$(document).on("focusout blur",".page:not(.menu)",function(){var t=$(this);t.text().replace(" ","").length||t.empty(),$(this).attr("contenteditable","false"),$(this).removeClass("f-italic"),t.text().length<1&&t.text("Untitled"),i.$activePage=null,$(document).trigger("datos.changePage",[t.attr("data-target-i"),t.text()])});$(document).on("dblclick",".page:not(.menu)",function(){var t=this;$(this).attr("contenteditable","true"),$(this).addClass("f-italic"),$(this).focus(),setTimeout(function(){i.setCaretPosition($(t)[0],"last")},0),i.$activePage=$(this)});$(document).on("click",".page:not(.menu)",function(){i.selectPage($(this)),m.toggleSelection(!0),n.formulaBar(!1),$(document).trigger("datos.cardUnselected")});$("#addPage").on("click",function(){i.addPage("",!0)})},t.prototype.SmartCards=function(){$("#addAnother").on("click",function(){var t=m.addCard().find(".text");setTimeout(function(){t.dblclick()},0)});$("#addAnotherGrid").on("click",function(){var t=o.addCard().find(".text");setTimeout(function(){t.dblclick()},0)})},t.prototype.SmartTextBox=function(){$(document).on("dblclick",".text",function(t){$(t.target).hasClass("cell")&&null===b.$activeDataTable||(v.disable(),v.enable($(this)))});$(document).on("click",function(t){null===v.$activeText||$(t.target).is(v.$activeText)||$(t.target).context!==v.$activeText.context&&(v.defaultVal(v.$activeText),"LI"===v.$activeText.parent()[0].nodeName?v.smartOption(v.$activeText,!1):v.disable())});$(document).on("click","._addOption",function(){null!==v.$activeText&&v.smartOption(v.$activeText,!1);var t=A.option("");t.insertBefore($(this).parent()),setTimeout(function(){t.find(".text").dblclick()},100);var e=$(this).parents("div.card");e.length||(e=$(this).parents("li.grid")),e=e.attr("data-origin-i"),$(document).trigger("datos.addOption",[e]),v.$textList=$(".text")})},t.prototype.TabularSystem=function(){$(document).on("dblclick",".dataTable",function(){if(!$(b.$activeDataTable).is($(this))){null!==b.$activeDataTable&&b.close(!0),b.$activeDataTable=$(this),$(this).addClass("active"),$(this).find(".secretTableTool").each(function(){$(this).removeClass("secretTableTool")});var t=$(this).find("tbody tr th:eq(0)");b.moveSelector(t),setTimeout(function(){t.trigger("datos.disableText")},0),$(this).parents(".datosSheet").css("overflow",""),$(document).trigger("datos.cardUnselected"),m.toggleSelection(!1),n.div1(["insertRow","insertCol","removeRow","removeCol"]),n.div2(["lockCell","cardFormat","framework","deleteCard"]),n.formulaBar(!0)}});$(document).on("click",".dataTable th, td",function(){null!==b.$activeDataTable&&b.$activeDataTable.has($(this)).length&&($(this).is(b.$selectedCell)||v.disable(),b.moveSelector($(this)))});$(document).on("mousedown",".dataTable",function(t){t.preventDefault()});$(document).on("click",function(t){var e=$("input#formula"),a=null!==b.$activeDataTable,n=$("#vToolbar").has($(t.target)).length,i=$(t.target).is(e)||n||$("#subTool").has($(t.target)).length;u.formulaFocused=!!$(t.target).is(e),!a||b.$activeDataTable.has($(t.target)).length||i||b.close()})},t.prototype.vToolbar=function(){$(document).on("click",".tool[data-id='insertRow']",function(t){var e=b.getRowIndex();if(!t.shiftKey||0<e){var a=t.shiftKey?-1:0;b.addRow(e,a)}});$(document).on("click",".tool[data-id='insertCol']",function(t){var e=b.getColIndex();if(!t.shiftKey||1<e){var a=t.shiftKey?-1:0;b.addColumn(e,a)}});$(document).on("click",".tool[data-id='removeRow']",function(){if(0<b.getRowIndex()){var t=b.$activeDataTable.find("tbody"),e=b.getColIndex(),a=b.getRowIndex(),n=t.find("tr").eq(a-1).children().eq(e),i=t.find("tr").eq(a);b.moveSelector(n),0<t.has(i).length&&b.rowRemove(a)}});$(document).on("click",".tool[data-id='removeCol']",function(){if(1<b.getColIndex()){var t=b.$activeDataTable.find("tbody").find("tr:eq(0)"),e=t.children().eq(b.getColIndex()-1),a=t.children().eq(b.getColIndex()),n=b.getColIndex();b.moveSelector(e),0<t.has(a).length&&(b.columnRemove(n),b.moveSelector(e))}});var i=!1;$(document).on("datos.toggleSubTool",function(){i=!1,$("#subTool").hide()});$(document).on("click",".tool[data-id='cardFormat']",function(){var t=$(this).offset().top,e=$("#subTool");if(e.fixedCss("top",t),i)i=!1,e.hide();else{$(".subtool").removeClass("active");var a=$(".card.selected");if(a.length<2){var n=a.attr("data-origin-i");null!=n&&$(document).trigger("datos.preFormatCard",[n])}i=!0,e.show()}});$(document).on("click",function(t){var e=$("#subTool"),a=0<$(".tool[data-id='cardFormat']").has($(t.target)).length,n=0<e.has($(t.target)).length;!i||n||a||(i=!1,e.hide())});$(document).on("click",".subtool",function(){$(".subtool.active").removeClass("active"),$(this).addClass("active");var t=$(".card.selected"),e=t.map(function(t,e){return $(e).attr("data-origin-i")}).toArray();if("tabular"===$(this).attr("data-id")){$("ul.sortableOption.hiddenOrig").remove();var a=$(".preview");a.removeClass("preview"),a.each(function(){b.generate($(this).find("table.dataTable"))}),$(document).trigger("datos.changeType",[e,"tabular"])}"standard"===$(this).attr("data-id")&&($("div.datosSheet.hiddenOrig").remove(),$(".preview").removeClass("preview"),$(document).trigger("datos.changeType",[e,"standard"])),t.trigger("click")});$(document).on("mouseenter",".subtool",function(){var s=$(this);$(this).hasClass("active")||$(".card.selected").each(function(){var t=$(this).find("ul.sortableOption");if("tabular"===s.attr("data-id")&&0<t.length){var e=m.getOptions(t),a=$("<div/>",{class:"datosSheet preview"}).css("position","relative");t.addClass("hiddenOrig"),t.hide(),$(this).append(a);var n=A.dataTable(),i=n.find("tbody");i.append(A.dataTableCriteriaH(["Variables","Untitled Criterion"])),$(e).each(function(t,e){i.append(A.dataTableCriteria([e.value,""]))}),a.append(n)}var r=$(this).find("div.datosSheet");if("standard"===s.attr("data-id")&&0<r.length){var o=m.getVariables(r),d=$("<ul/>",{class:"sortableOption preview"});r.addClass("hiddenOrig"),r.hide(),$(this).append(d),$(o).each(function(t,e){d.append(A.option(e))}),d.append(A.otherOpt())}})});$(document).on("mouseleave",".subtool",function(){var t=$(".sortableOption.hiddenOrig");t.removeClass("hiddenOrig"),t.show();var e=$(".datosSheet.hiddenOrig");e.removeClass("hiddenOrig"),e.show(),$(".preview").remove()})},t}(),c=null;$.fn.extend({addContextMenu:function(r){this.on("contextmenu",function(t){t.preventDefault(),t.stopPropagation();var a,n=$("#contextMenu");null!==c&&c.is($(this))||(n.length?n.empty():(n=A.contextMenu.container(),$("body").append(n),d.noZoomContextMenu.container(n)),$(r).each(function(t,e){a=$("<li/>"),0<$.inArray(this.icon,[void 0,null])||a.append(A.contextMenu.icon(this.icon)),$.inArray(this.name,[void 0,null])||(this.name="Untitled Item"),a.append(A.contextMenu.name(this.name)),!0===this.disabled?a.addClass("disabled"):a.on("click",function(){0<$.inArray(e.callback,[null,void 0])||e.callback(),n.hide()}),n.append(a)}),c=$(this),d.noZoomContextMenu.item(n));n.show();var e=n.css("height"),i=n.css("width");e=parseInt(e),i=parseInt(i),$(window).width()<t.pageX+i?n.css({right:10/$(window).height()*100+"vh",left:""}):n.css({left:t.pageX/$(window).height()*100+"vh",right:""}),$(window).height()<t.pageY+e?n.css({bottom:10/$(window).height()*100+"vh",top:""}):n.css({top:t.pageY/$(window).height()*100+"vh",bottom:""})})}}),$(document).bind("mousedown",function(t){0<!$(t.target).parents("#contextMenu").length&&$("#contextMenu").hide()});var l=function(){var t=function(){this.Document(),this.PageSystem()};return t.prototype.Document=function(){$(document).addContextMenu([{name:"<b>Version:</b> 1.0.0",icon:"share-alt",disabled:!0}])},t.prototype.PageSystem=function(){$("#addPage").addContextMenu([{name:"Standard Page",icon:"align-justify",callback:function(){i.addPage("",!0)}},{name:"Handler Page",icon:"tasks",callback:function(){i.addPage("",!0,"handler")}}])},t}();localStorage.clear(),new e,i.run(),v.run(),m.run(),new b,new a,new s,new l;var h=$("body");h.on("selectstart",function(t){if("TEXTAREA"!==(t.target||t.srcElement).nodeName&&!$(t.target).hasClass("page")&&!$(t.target).is($("input#formula")))return!1});